{% extends 'base.html' %}
{% block content %}
<h1 class="h5">Resultados del escaneo</h1>
<p><strong>Objetivo:</strong> {{ report.target }}</p>
<p><strong>Total hallazgos:</strong> {{ report.count }}</p>

{% if report.findings|length == 0 %}
<div class="alert alert-success">No se detectaron vulnerabilidades básicas con los payloads usados.</div>
{% else %}
<table class="table table-sm table-bordered">
  <thead><tr><th>Tipo</th><th>Objetivo</th><th>Payload</th><th>Evidencia</th></tr></thead>
  <tbody>
  {% for f in report.findings %}
    <tr>
      <td>{{ f.vuln_type }}</td>
      <td class="small text-break">{{ f.target }}</td>
      <td><code>{{ f.payload }}</code></td>
      <td class="small">{{ f.evidence }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endif %}

<h2 class="h6 mt-4">Formularios detectados ({{ forms|length }})</h2>
{% if forms|length %}
  <ul class="list-group small">
  {% for frm in forms %}
    <li class="list-group-item">
      <div><strong>Método:</strong> {{ frm.method|upper }} <strong>Action:</strong> {{ frm.action }}</div>
      <div><strong>Inputs:</strong>
        {% for inp in frm.inputs %}
          <span class="badge text-bg-secondary">{{ inp.name }} ({{ inp.type }})</span>
        {% endfor %}
      </div>
    </li>
  {% endfor %}
  </ul>
{% else %}
  <p class="text-muted">No se encontraron formularios.</p>
{% endif %}

<a href="/" class="btn btn-outline-secondary mt-4">Nuevo escaneo</a>
{% endblock %}